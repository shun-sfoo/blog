---
title: "数据结构-红黑树"
date: 2020-12-29T22:10:09+08:00
categories: ["Java"]
tags: ["data-struct"]
draft: false
---

# 红黑树性质

结合 2-3 树理解

1. 每个节点或者是红色的，或者是黑色的
2. 根节点是黑色的
3. 每一个叶子节点（最后的空节点） 是黑色的
4. 如果一个节点是红色的，那么他的孩子节点都是黑色的
5. 从任意一个节点到叶子节点，经过的黑色节点是一样的

## 2-3 树

有助于理解红黑树和 B 类树

## 性质

满足二分搜索树的基本性质
节点可以存放一个元素或者两个元素
每个节点有 2 个孩子(2 节点)或者 3 个孩子(3 节点)
2-3 树是一颗绝对平衡的树

## 2-3 树增加节点

新添加节点不会添加到空节点上

```
[37] -> [42] = [37][42]

-----------------------------------------------------
[12] -> [37][42] = [12][37][42] = [37]
                                  /    \
                                [12]   [42]

-----------------------------------------------------

[18] -> [37]   =        [37]
        /  \         /       \
     [12]  [42]   [12][18]    [42]

-----------------------------------------------------

[6]  ->    [37]          =        [37]     =    [37]   =     [12][37]
         /       \              /      \        /   \          / |   \
      [12][18]    [42]    [6][12][18]   [42]   [12] [42]    [6] [18] [42]
                                               /  \
                                             [6]  [18]

-----------------------------------------------------

```

## 红黑树和 2-3 树

相等性，红黑树可以看作 2-3 树
当有三节点时左侧节点作为孩子节点标红表示 2-3 树中两个节点并列
所有的红色节点都是左倾斜的(或者实现右倾斜的版本)
![BRTree](/BRTree/BR-23.png)
![BRTree1](/BRTree/BR-23-1.png)

添加节点默认为红色: 2-3 树中新添加节点总是先融合

红黑树是保持“黑平衡”的二叉树
严格意义上，不是平衡二叉树 最大高度： `2logn` o(logn)

## 红黑树添加新元素

- 2-3 树中添加一个新元素
- 添加进 2 节点，形成一个 3 节点
- 添加进 3 节点，暂时形成一个 4 节点
- 永远添加红色节点
- 根节点为黑色节点

![ADD](/BRTree/BRTree_ADD.png)

图中流程可以总结为： **流程想象对应 2-3 树的变换**

1. 如果节点右孩子为红色而左孩子不为红色（都为红只需要颜色翻转）进行左旋转操作，
   换上去节点的颜色为旋转节点的颜色，旋转节点颜色变成红色, 返回换上去的节点。
   (对应 2 节点插入到右边和 3 节点插入到中间的情况)

```java
//   node                     x
//  /   \     左旋转         /  \
// T1   x   --------->   node   T3
//     / \              /   \
//    T2 T3            T1   T2
private Node leftRotate(Node node) {

    Node x = node.right;

    // 左旋转
    node.right = x.left;
    x.left = node;

    x.color = node.color;
    node.color = RED;

    return x;
}
```

2.如果左孩子为红色并且左孩子的左孩子也为红色进行右旋转操作。
换上去节点的颜色为旋转节点的颜色，旋转节点颜色变成红色。

```java
//     node                   x
//    /   \     右旋转       /  \
//   x    T2   ------->   y   node
//  / \                       /  \
// y  T1                     T1  T2
private Node rightRotate(Node node) {

    Node x = node.left;

    // 右旋转
    node.left = x.right;
    x.right = node;

    x.color = node.color;
    node.color = RED;

    return x;
}
```

3.如果节点的左右孩子都为红色节点进行颜色翻转。

```java
// 颜色翻转
private void flipColors(Node node) {
    node.color = RED;
    node.left.color = BLACK;
    node.right.color = BLACK;
}
```

## TODO 右倾红黑树 Splay Tree （伸展树）
